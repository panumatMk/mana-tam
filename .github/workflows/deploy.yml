name: Deploy to Firebase Hosting

on:
  push:
    branches:
      - master # ‡∏´‡∏£‡∏∑‡∏≠ main ‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠ branch ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4 # ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏õ‡πá‡∏ô v4

      - name: Setup Node.js
        uses: actions/setup-node@v4 # ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏õ‡πá‡∏ô v4
        with:
          node-version: 20
          cache: 'npm'

      - name: Install dependencies
        run: npm install

      - name: Build Project
        run: npm run build
        env:
          VITE_LIFF_ID: ${{ secrets.VITE_LIFF_ID }}

      # üöÄ Deploy to Firebase Hosting
      - name: Deploy to Firebase
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          # üí° ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Secret ‡∏ä‡∏∑‡πà‡∏≠ FIREBASE_TOKEN ‡πÉ‡∏ô GitHub ‡∏Å‡πà‡∏≠‡∏ô
          repoToken: '${{ secrets.GITHUB_TOKEN }}'
          firebaseServiceAccount: ${{ secrets.FIREBASE_SERVICE_ACCOUNT }}

          # üî¥ ‡πÅ‡∏Å‡πâ YOUR_PROJECT_ID_HERE ‡πÄ‡∏õ‡πá‡∏ô Project ID ‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô Firebase Console
          projectId: '${{secrets.PROJECT_ID}}'

          # (Optional) ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Hosting ‡πÉ‡∏´‡πâ deploy ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå dist
          entryPoint: ./
          channelId: live
